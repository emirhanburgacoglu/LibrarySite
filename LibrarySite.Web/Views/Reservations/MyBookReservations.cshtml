@using System.Linq
@using LibrarySite.Core.Domain @* Enum tipine eri≈ümek i√ßin gerekebilir *@
@model List<LibrarySite.Core.Domain.Reservation>

@{
    ViewData["Title"] = "My Book Reservations";
}

<style>
    /* ... (Mevcut CSS stil kodlarƒ±n aynen kalabilir) ... */
    .res-page-header { margin-bottom: 2.5rem; }
    .res-list { display: flex; flex-direction: column; gap: 1rem; }
    .res-item {
        background: #ffffff;
        border-radius: 16px;
        border: 1px solid #f1f5f9;
        padding: 1.25rem 1.5rem;
        transition: all 0.2s ease;
        display: grid;
        grid-template-columns: auto 1fr auto;
        align-items: center;
        gap: 2rem;
    }
    .res-item:hover {
        border-color: var(--member-primary);
        box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        transform: translateX(5px);
    }
    .res-icon {
        width: 50px; height: 50px; background: #f8fafc; border-radius: 12px;
        display: flex; align-items: center; justify-content: center;
        font-size: 1.5rem; border: 1px solid #e2e8f0;
    }
    .res-info h5 { font-weight: 700; margin-bottom: 0.25rem; color: var(--text-main); }
    .res-date { font-size: 0.85rem; color: #94a3b8; display: flex; align-items: center; gap: 6px; }
    .status-pill { font-size: 0.75rem; font-weight: 700; padding: 0.4rem 1rem; border-radius: 10px; text-transform: uppercase; letter-spacing: 0.5px; }
    .status-pending { background: #fff7ed; color: #c2410c; border: 1px solid #ffedd5; }
    .status-approved { background: #ecfdf5; color: #059669; border: 1px solid #d1fae5; }
    .status-cancelled { background: #fef2f2; color: #dc2626; border: 1px solid #fee2e2; }
    .status-default { background: #f1f5f9; color: #475569; }

    @@media (max-width: 768px) {
        .res-item { grid-template-columns: 1fr; text-align: center; gap: 1rem; }
        .res-icon, .res-date { margin: 0 auto; }
        .res-item:hover { transform: none; }
    }
</style>

<div class="res-page-header">
    <h2 class="fw-800 mb-1">My Book Reservations</h2>
    <p class="text-muted mb-0">Track your current and past book requests.</p>
</div>

@if (!Model.Any())
{
    <div class="text-center py-5 bg-light rounded-4 border-2 border-dashed">
        <div class="display-1 mb-3">üìñ</div>
        <h4 class="fw-700">No Reservations Yet</h4>
        <p class="text-muted">You haven't made any book reservations. Start exploring our collection!</p>
        <a asp-controller="Books" asp-action="Index" class="btn btn-primary rounded-pill px-4 mt-2" 
           style="background: var(--member-gradient); border:none;">Browse Books</a>
    </div>
}
else
{
    <div class="res-list animate__animated animate__fadeIn">
        @foreach (var r in Model)
        {
            // HATA D√úZELTME: Enum deƒüerini string'e √ßevirip √∂yle kontrol ediyoruz
            var statusString = r.Status.ToString().ToLower();
            
            var statusClass = statusString switch
            {
                "pending" => "status-pending",
                "approved" => "status-approved",
                "cancelled" => "status-cancelled",
                _ => "status-default"
            };

            <div class="res-item">
                <div class="res-icon">
                    @* HATA D√úZELTME: Enum kar≈üƒ±la≈ütƒ±rmasƒ± *@
                    @if (statusString == "approved") { <span>‚úÖ</span> }
                    else if (statusString == "cancelled") { <span>‚ùå</span> }
                    else { <span>‚è≥</span> }
                </div>

                <div class="res-info">
                    <h5>Book Reference ID: #@r.BookId</h5>
                    <div class="res-date">
                        <span>üìÖ</span> Reserved on @r.CreatedAt.ToString("f")
                    </div>
                </div>

                <div class="res-status">
                    <span class="status-pill @statusClass">@r.Status.ToString()</span>
                </div>
            </div>
        }
    </div>
}